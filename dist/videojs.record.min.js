!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("videojs"),require("RecordRTC")):"function"==typeof define&&define.amd?define("VideojsRecord",["videojs","RecordRTC"],t):"object"==typeof exports?exports.VideojsRecord=t(require("videojs"),require("RecordRTC")):e.VideojsRecord=t(e.videojs,e.RecordRTC)}(window,function(e,t){return function(e){var t={};function i(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(r,o,function(t){return e[t]}.bind(null,o));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=15)}([function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t){function i(t){return e.exports=i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},i(t)}e.exports=i},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function i(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}},function(e,t,i){var r=i(10),o=i(11);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?o(e):t}},function(e,t,i){var r=i(18);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(t,i){t.exports=e},function(e,t,i){i(1);var r=i(17);function o(t,i,n){return"undefined"!=typeof Reflect&&Reflect.get?e.exports=o=Reflect.get:e.exports=o=function(e,t,i){var o=r(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(i):n.value}},o(t,i,n||t)}e.exports=o},function(e,t,i){"use strict";var r=i(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(i(2)),n=function e(){(0,o.default)(this,e)};n.READY="ready",n.ERROR="error",n.LOADEDMETADATA="loadedmetadata",n.LOADSTART="loadstart",n.USERINACTIVE="userinactive",n.TIMEUPDATE="timeupdate",n.DURATIONCHANGE="durationchange",n.ENDED="ended",n.PAUSE="pause",n.PLAY="play",n.DEVICE_READY="deviceReady",n.DEVICE_ERROR="deviceError",n.START_RECORD="startRecord",n.STOP_RECORD="stopRecord",n.FINISH_RECORD="finishRecord",n.RECORD_COMPLETE="recordComplete",n.PROGRESS_RECORD="progressRecord",n.TIMESTAMP="timestamp",n.ENUMERATE_READY="enumerateReady",n.ENUMERATE_ERROR="enumerateError",n.AUDIO_BUFFER_UPDATE="audioBufferUpdate",n.AUDIO_OUTPUT_READY="audioOutputReady",n.FINISH_CONVERT="finishConvert",n.ENTER_PIP="enterPIP",n.LEAVE_PIP="leavePIP",n.ENTERPICTUREINPICTURE="enterpictureinpicture",n.LEAVEPICTUREINPICTURE="leavepictureinpicture",Object.freeze(n);var a=n;t.default=a,e.exports=t.default},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SCREEN_ONLY=t.ANIMATION=t.AUDIO_VIDEO=t.VIDEO_ONLY=t.AUDIO_ONLY=t.IMAGE_ONLY=t.getRecorderMode=void 0;t.IMAGE_ONLY="image_only";t.AUDIO_ONLY="audio_only";t.VIDEO_ONLY="video_only";t.AUDIO_VIDEO="audio_video";t.ANIMATION="animation";t.SCREEN_ONLY="screen_only";t.getRecorderMode=function(e,t,i,o,n){return r(e)?"image_only":r(o)?"animation":r(n)?"screen_only":r(t)&&!r(i)?"audio_only":r(t)&&r(i)?"audio_video":!r(t)&&r(i)?"video_only":void 0};var r=function(e){return e===Object(e)||!0===e}},function(e,t){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(t){return"function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?e.exports=r=function(e){return i(e)}:e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":i(e)},r(t)}e.exports=r},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,i){"use strict";var r=i(0);Object.defineProperty(t,"__esModule",{value:!0}),t.isFirefox=t.isSafari=t.isChrome=t.isOpera=t.isEdge=t.detectBrowser=void 0;var o=r(i(33)),n=function(){var e={browser:null,version:null,minVersion:null};if(void 0===o.default||!o.default.navigator)return e.browser="Not a supported browser.",e;if(navigator.mozGetUserMedia)e.browser="firefox",e.version=a(navigator.userAgent,/Firefox\/(\d+)\./,1),e.minVersion=31;else if(navigator.webkitGetUserMedia)e.browser="chrome",e.version=a(navigator.userAgent,/Chrom(e|ium)\/(\d+)\./,2),e.minVersion=38;else if(navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/))e.browser="edge",e.version=a(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2),e.minVersion=10547;else{if(!o.default.RTCPeerConnection||!navigator.userAgent.match(/AppleWebKit\/(\d+)\./))return e.browser="Not a supported browser.",e;e.browser="safari",e.version=a(navigator.userAgent,/AppleWebKit\/(\d+)\./,1)}return e};t.detectBrowser=n;var a=function(e,t,i){var r=e.match(t);return r&&r.length>=i&&parseInt(r[i],10)};t.isEdge=function(){return"edge"===n().browser};t.isSafari=function(){return"safari"===n().browser};t.isOpera=function(){return!!o.default.opera||-1!==navigator.userAgent.indexOf("OPR/")};t.isChrome=function(){return"chrome"===n().browser};t.isFirefox=function(){return"firefox"===n().browser}},function(e,t,i){"use strict";var r=i(0);Object.defineProperty(t,"__esModule",{value:!0}),t.WEBMWASM=t.VMSG=t.OPUSRECORDER=t.LAMEJS=t.RECORDERJS=t.LIBVORBISJS=t.RECORDRTC=t.VIDEO_PLUGINS=t.AUDIO_PLUGINS=t.RECORD_PLUGINS=t.RecordEngine=void 0;var o=r(i(2)),n=r(i(3)),a=r(i(4)),s=r(i(1)),u=r(i(5)),l=r(i(6)),d=r(i(8)),c=i(14),h=l.default.getComponent("Component");t.RECORDRTC="recordrtc";t.LIBVORBISJS="libvorbis.js";t.RECORDERJS="recorder.js";t.LAMEJS="lamejs";t.OPUSRECORDER="opus-recorder";t.VMSG="vmsg";t.WEBMWASM="webm-wasm";var f=["libvorbis.js","recorder.js","lamejs","opus-recorder","vmsg"];t.AUDIO_PLUGINS=f;var p=["webm-wasm"];t.VIDEO_PLUGINS=p;var y=f.concat(p);t.RECORD_PLUGINS=y;var v=function(e){function t(e,i){return(0,o.default)(this,t),i.evented=!0,(0,a.default)(this,(0,s.default)(t).call(this,e,i))}return(0,u.default)(t,e),(0,n.default)(t,[{key:"dispose",value:function(){void 0!==this.recordedData&&URL.revokeObjectURL(this.recordedData)}},{key:"destroy",value:function(){}},{key:"addFileInfo",value:function(e){(0,c.addFileInfo)(e)}},{key:"onStopRecording",value:function(e){this.recordedData=e,this.addFileInfo(this.recordedData),this.dispose(),this.trigger(d.default.RECORD_COMPLETE)}},{key:"saveAs",value:function(e){var t=e[Object.keys(e)[0]];(0,c.downloadBlob)(t,this.recordedData)}}]),t}(h);t.RecordEngine=v,l.default.RecordEngine=v,h.registerComponent("RecordEngine",v)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addFileInfo=t.blobToArrayBuffer=t.downloadBlob=void 0;t.downloadBlob=function(e,t){if(void 0!==navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(t,e);if(void 0!==navigator.msSaveBlob)return navigator.msSaveBlob(t,e);var i=document.createElement("a");i.href=URL.createObjectURL(t),i.download=e,i.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(i),"function"==typeof i.click?i.click():(i.target="_blank",i.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),URL.revokeObjectURL(i.href)};t.blobToArrayBuffer=function(e){return new Promise(function(t,i){var r=new FileReader;r.onloadend=function(){t(r.result)},r.onerror=function(e){i(e.error)},r.readAsArrayBuffer(e)})};t.addFileInfo=function(e,t){if(e instanceof Blob||e instanceof File){void 0===t&&(t=new Date);try{e.lastModified=t.getTime(),e.lastModifiedDate=t}catch(e){if(!(e instanceof TypeError))throw e}var i="."+e.type.split("/")[1];i.indexOf(";")>-1&&(i=i.split(";")[0]);try{e.name=t.getTime()+i}catch(e){if(!(e instanceof TypeError))throw e}}}},function(e,t,i){i(16),e.exports=i(39)},function(e,t,i){"use strict";var r=i(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Record=void 0;var o=r(i(10)),n=r(i(2)),a=r(i(3)),s=r(i(4)),u=r(i(11)),l=r(i(1)),d=r(i(7)),c=r(i(5)),h=r(i(6)),f=r(i(19)),p=r(i(20)),y=r(i(21)),v=r(i(22)),g=r(i(23)),m=r(i(24)),E=r(i(25)),R=r(i(8)),T=r(i(29)),O=r(i(30)),b=r(i(31)),D=r(i(32)),_=i(12),C=i(35),A=i(9),I=h.default.getPlugin("plugin"),k=h.default.getComponent("Player");k.prototype.play=function(){var e=this.techGet_("play");return void 0!==e&&"function"==typeof e.then&&e.then(null,function(e){}),e};var w=function(e){function t(e,i){var r;(0,n.default)(this,t),r=(0,s.default)(this,(0,l.default)(t).call(this,e,i)),e.addClass("vjs-record"),r.loadOptions(),r.resetState();var o="av-perm";switch(r.getRecordType()){case A.IMAGE_ONLY:case A.VIDEO_ONLY:case A.ANIMATION:o="video-perm";break;case A.AUDIO_ONLY:o="audio-perm";break;case A.SCREEN_ONLY:o="screen-perm"}if(y.default.prototype.buildCSSClass=function(){return"vjs-record vjs-device-button vjs-control vjs-icon-"+o},e.deviceButton=new y.default(e,i),e.addChild(e.deviceButton),e.recordIndicator=new m.default(e,i),e.recordIndicator.hide(),e.addChild(e.recordIndicator),e.recordCanvas=new p.default(e,i),e.recordCanvas.hide(),e.addChild(e.recordCanvas),e.animationDisplay=new f.default(e,i),e.animationDisplay.hide(),e.addChild(e.animationDisplay),e.cameraButton=new v.default(e,i),e.cameraButton.hide(),e.recordToggle=new g.default(e,i),e.recordToggle.hide(),e.pipToggle=new E.default(e,i),e.pipToggle.hide(),!0===r.pictureInPicture&&(r.onEnterPiPHandler=r.onEnterPiP.bind((0,u.default)(r)),r.onLeavePiPHandler=r.onLeavePiP.bind((0,u.default)(r))),r.player.options_.controlBar){["deviceButton","recordIndicator","cameraButton","recordToggle","pipToggle"].forEach(function(e){void 0!==r.player.options_.controlBar[e]&&(r.player[e].layoutExclude=!0,r.player[e].hide())})}return r.player.one(R.default.READY,r.setupUI.bind((0,u.default)(r))),r}return(0,c.default)(t,e),(0,a.default)(t,[{key:"loadOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=h.default.mergeOptions(O.default,this.player.options_.plugins.record,e);this.recordImage=t.image,this.recordAudio=t.audio,this.recordVideo=t.video,this.recordAnimation=t.animation,this.recordScreen=t.screen,this.maxLength=t.maxLength,this.maxFileSize=t.maxFileSize,this.msDisplayMax=parseFloat(t.msDisplayMax),this.debug=t.debug,this.pictureInPicture=t.pip,this.recordTimeSlice=t.timeSlice,this.autoMuteDevice=t.autoMuteDevice,this.videoFrameWidth=t.frameWidth,this.videoFrameHeight=t.frameHeight,this.videoEngine=t.videoEngine,this.videoRecorderType=t.videoRecorderType,this.videoMimeType=t.videoMimeType,this.videoWorkerURL=t.videoWorkerURL,this.videoWebAssemblyURL=t.videoWebAssemblyURL,this.convertEngine=t.convertEngine,this.audioEngine=t.audioEngine,this.audioRecorderType=t.audioRecorderType,this.audioWorkerURL=t.audioWorkerURL,this.audioWebAssemblyURL=t.audioWebAssemblyURL,this.audioBufferSize=t.audioBufferSize,this.audioSampleRate=t.audioSampleRate,this.audioBitRate=t.audioBitRate,this.audioChannels=t.audioChannels,this.audioMimeType=t.audioMimeType,this.audioBufferUpdate=t.audioBufferUpdate,this.animationFrameRate=t.animationFrameRate,this.animationQuality=t.animationQuality}},{key:"setupUI",value:function(){var e=this;switch(this.player.controlBar.addChild(this.player.cameraButton),this.player.controlBar.el().insertBefore(this.player.cameraButton.el(),this.player.controlBar.el().firstChild),this.player.controlBar.el().insertBefore(this.player.recordToggle.el(),this.player.controlBar.el().firstChild),this.player.controlBar.addChild(this.player.pipToggle),void 0!==this.player.controlBar.remainingTimeDisplay&&(this.player.controlBar.remainingTimeDisplay.el().style.display="none"),void 0!==this.player.controlBar.liveDisplay&&(this.player.controlBar.liveDisplay.el().style.display="none"),this.player.loop(!1),this.getRecordType()){case A.AUDIO_ONLY:this.surfer=this.player.wavesurfer();break;case A.IMAGE_ONLY:case A.VIDEO_ONLY:case A.AUDIO_VIDEO:case A.ANIMATION:case A.SCREEN_ONLY:this.player.bigPlayButton.hide(),this.player.one(R.default.LOADEDMETADATA,function(){e.setDuration(e.maxLength)}),this.player.one(R.default.LOADSTART,function(){e.setDuration(e.maxLength)}),!0===this.player.usingNativeControls_&&void 0!==this.player.tech_.el_&&(this.player.tech_.el_.controls=!1),this.player.removeTechControlsListeners_(),this.player.options_.controls&&(void 0!==this.player.controlBar.progressControl&&this.player.controlBar.progressControl.hide(),this.player.on(R.default.USERINACTIVE,function(t){e.player.userActive(!0)}),this.player.controlBar.show(),this.player.controlBar.el().style.display="flex")}if(this.player.off(R.default.TIMEUPDATE),this.player.off(R.default.DURATIONCHANGE),this.player.off(R.default.LOADEDMETADATA),this.player.off(R.default.LOADSTART),this.setDuration(this.maxLength),this.player.options_.plugins.record&&this.player.options_.plugins.record.hotKeys&&!1!==this.player.options_.plugins.record.hotKeys){var t=this.player.options_.plugins.record.hotKeys;!0===t&&(t=T.default),this.player.options_.userActions={hotkeys:t}}void 0!==this.player.controlBar.playToggle&&this.player.controlBar.playToggle.hide()}},{key:"isRecording",value:function(){return this._recording}},{key:"isProcessing",value:function(){return this._processing}},{key:"isDestroyed",value:function(){var e=null===this.player;return!1===e&&(e=null===this.player.children()),e}},{key:"getDevice",value:function(){var e=this;if(void 0===this.deviceReadyCallback&&(this.deviceReadyCallback=this.onDeviceReady.bind(this)),void 0===this.deviceErrorCallback&&(this.deviceErrorCallback=this.onDeviceError.bind(this)),void 0===this.engineStopCallback&&(this.engineStopCallback=this.onRecordComplete.bind(this)),this.getRecordType()===A.SCREEN_ONLY){if(void 0===navigator.mediaDevices||void 0===navigator.mediaDevices.getDisplayMedia)return void this.player.trigger(R.default.ERROR,"This browser does not support navigator.mediaDevices.getDisplayMedia")}else if(void 0===navigator.mediaDevices||void 0===navigator.mediaDevices.getUserMedia)return void this.player.trigger(R.default.ERROR,"This browser does not support navigator.mediaDevices.getUserMedia");switch(this.getRecordType()){case A.AUDIO_ONLY:this.mediaType={audio:"auto"===this.audioRecorderType||this.audioRecorderType,video:!1},this.surfer.surfer.microphone.un(R.default.DEVICE_READY,this.deviceReadyCallback),this.surfer.surfer.microphone.un(R.default.DEVICE_ERROR,this.deviceErrorCallback),this.surfer.surfer.microphone.on(R.default.DEVICE_READY,this.deviceReadyCallback),this.surfer.surfer.microphone.on(R.default.DEVICE_ERROR,this.deviceErrorCallback),this.surfer.setupPlaybackEvents(!1),this.surfer.liveMode=!0,this.surfer.surfer.microphone.paused=!1,"suspended"===this.surfer.surfer.backend.ac.state&&this.surfer.surfer.backend.ac.resume(),!0===this.audioBufferUpdate&&(this.surfer.surfer.microphone.reloadBufferFunction=function(t){e.surfer.surfer.microphone.paused||(e.surfer.surfer.empty(),e.surfer.surfer.loadDecodedBuffer(t.inputBuffer),e.player.recordedData=t.inputBuffer,e.player.trigger(R.default.AUDIO_BUFFER_UPDATE))}),this.surfer.surfer.microphone.start();break;case A.IMAGE_ONLY:case A.VIDEO_ONLY:this.mediaType={audio:!1,video:"auto"===this.videoRecorderType||this.videoRecorderType},navigator.mediaDevices.getUserMedia({audio:!1,video:this.getRecordType()===A.IMAGE_ONLY?this.recordImage:this.recordVideo}).then(this.onDeviceReady.bind(this)).catch(this.onDeviceError.bind(this));break;case A.AUDIO_VIDEO:this.mediaType={audio:"auto"===this.audioRecorderType||this.audioRecorderType,video:"auto"===this.videoRecorderType||this.videoRecorderType},navigator.mediaDevices.getUserMedia({audio:this.recordAudio,video:this.recordVideo}).then(this.onDeviceReady.bind(this)).catch(this.onDeviceError.bind(this));break;case A.ANIMATION:this.mediaType={audio:!1,video:!1,gif:!0},navigator.mediaDevices.getUserMedia({audio:!1,video:this.recordAnimation}).then(this.onDeviceReady.bind(this)).catch(this.onDeviceError.bind(this));break;case A.SCREEN_ONLY:this.mediaType={audio:!1,video:!1,screen:!0,gif:!1},navigator.mediaDevices.getDisplayMedia({video:!0}).then(this.onDeviceReady.bind(this)).catch(this.onDeviceError.bind(this))}}},{key:"onDeviceReady",value:function(e){var t=this;if(this._deviceActive=!0,this.stream=e,this.player.deviceButton.hide(),this.setDuration(this.maxLength),this.setCurrentTime(0),void 0!==this.player.controlBar.playToggle&&this.player.controlBar.playToggle.hide(),this.off(this.player,R.default.TIMEUPDATE,this.playbackTimeUpdate),this.off(this.player,R.default.ENDED,this.playbackTimeUpdate),this.getRecordType()!==A.IMAGE_ONLY){if(this.getRecordType()!==A.AUDIO_ONLY&&(0,C.isAudioPluginActive)(this.audioEngine))throw new Error("Currently "+this.audioEngine+" is only supported in audio-only mode.");var i,r;switch(this.getRecordType()){case A.AUDIO_ONLY:i=(0,C.getAudioEngine)(this.audioEngine),r=this.audioEngine;break;default:i=(0,C.getVideoEngine)(this.videoEngine),r=this.videoEngine}try{this.engine=new i(this.player,this.player.options_)}catch(e){throw new Error("Could not load "+r+" plugin")}if(this.engine.on(R.default.RECORD_COMPLETE,this.engineStopCallback),this.engine.bufferSize=this.audioBufferSize,this.engine.sampleRate=this.audioSampleRate,this.engine.bitRate=this.audioBitRate,this.engine.audioChannels=this.audioChannels,this.engine.audioWorkerURL=this.audioWorkerURL,this.engine.audioWebAssemblyURL=this.audioWebAssemblyURL,this.engine.mimeType={video:this.videoMimeType,gif:"image/gif"},null!==this.audioMimeType&&"auto"!==this.audioMimeType&&(this.engine.mimeType.audio=this.audioMimeType),this.engine.videoWorkerURL=this.videoWorkerURL,this.engine.videoWebAssemblyURL=this.videoWebAssemblyURL,this.engine.video={width:this.videoFrameWidth,height:this.videoFrameHeight},this.engine.canvas={width:this.videoFrameWidth,height:this.videoFrameHeight},this.engine.quality=this.animationQuality,this.engine.frameRate=this.animationFrameRate,this.recordTimeSlice&&this.recordTimeSlice>0&&(this.engine.timeSlice=this.recordTimeSlice,this.engine.onTimeStamp=this.onTimeStamp.bind(this)),this.engine.setup(this.stream,this.mediaType,this.debug),""!==this.convertEngine){var o=(0,C.getConvertEngine)(this.convertEngine);try{this.converter=new o(this.player,this.player.options_)}catch(e){throw new Error("Could not load "+this.convertEngine+" plugin")}this.converter.setup(this.mediaType,this.debug)}["currentTimeDisplay","timeDivider","durationDisplay"].forEach(function(e){void 0!==(e=t.player.controlBar[e])&&(e.el().style.display="block",e.show())}),this.player.recordToggle.show()}else this.player.recordIndicator.disable(),this.retrySnapshot(),this.player.cameraButton.onStop(),this.player.cameraButton.show();this.getRecordType()!==A.AUDIO_ONLY?(this.mediaElement=this.player.el().firstChild,this.mediaElement.controls=!1,this.mediaElement.muted=!0,this.displayVolumeControl(!1),!0===this.pictureInPicture&&(this.player.pipToggle.show(),this.mediaElement.removeEventListener(R.default.ENTERPICTUREINPICTURE,this.onEnterPiPHandler),this.mediaElement.removeEventListener(R.default.LEAVEPICTUREINPICTURE,this.onLeavePiPHandler),this.mediaElement.addEventListener(R.default.ENTERPICTUREINPICTURE,this.onEnterPiPHandler),this.mediaElement.addEventListener(R.default.LEAVEPICTUREINPICTURE,this.onLeavePiPHandler)),this.load(this.stream),this.player.one(R.default.LOADEDMETADATA,function(){t.mediaElement.play(),t.player.trigger(R.default.DEVICE_READY)})):this.player.trigger(R.default.DEVICE_READY)}},{key:"onDeviceError",value:function(e){this._deviceActive=!1,this.isDestroyed()||(this.player.deviceErrorCode=e,this.player.trigger(R.default.DEVICE_ERROR))}},{key:"start",value:function(){var e=this;if(!this.isProcessing()){switch(this._recording=!0,void 0!==this.player.controlBar.playToggle&&this.player.controlBar.playToggle.hide(),this.off(this.player,R.default.TIMEUPDATE,this.playbackTimeUpdate),this.off(this.player,R.default.ENDED,this.playbackTimeUpdate),this.getRecordType()){case A.AUDIO_ONLY:this.surfer.setupPlaybackEvents(!1),this.surfer.surfer.microphone.paused=!1,this.surfer.liveMode=!0,this.surfer.surfer.microphone.play();break;case A.VIDEO_ONLY:case A.AUDIO_VIDEO:case A.SCREEN_ONLY:this.startVideoPreview();break;case A.ANIMATION:this.player.recordCanvas.hide(),this.player.animationDisplay.hide(),this.mediaElement.style.display="block",this.captureFrame().then(function(t){e.startVideoPreview()})}switch(this.autoMuteDevice&&this.muteTracks(!1),this.getRecordType()){case A.IMAGE_ONLY:this.createSnapshot(),this.player.trigger(R.default.START_RECORD);break;case A.VIDEO_ONLY:case A.AUDIO_VIDEO:case A.ANIMATION:case A.SCREEN_ONLY:this.player.one(R.default.LOADEDMETADATA,function(){e.startRecording()});break;default:this.startRecording()}}}},{key:"startRecording",value:function(){this.paused=!1,this.pauseTime=this.pausedTime=0,this.startTime=performance.now();this.countDown=this.player.setInterval(this.onCountDown.bind(this),100),void 0!==this.engine&&this.engine.dispose(),this.engine.start(),this.player.trigger(R.default.START_RECORD)}},{key:"stop",value:function(){this.isProcessing()||(this._recording=!1,this._processing=!0,this.getRecordType()!==A.IMAGE_ONLY?(this.player.trigger(R.default.STOP_RECORD),this.player.clearInterval(this.countDown),this.engine&&this.engine.stop(),this.autoMuteDevice&&this.muteTracks(!0)):this.player.recordedData&&this.player.trigger(R.default.FINISH_RECORD))}},{key:"stopDevice",value:function(){this.isRecording()?(this.player.one(R.default.FINISH_RECORD,this.stopStream.bind(this)),this.stop()):this.stopStream()}},{key:"stopStream",value:function(){if(this.stream){if(this._deviceActive=!1,this.getRecordType()===A.AUDIO_ONLY)return void this.surfer.surfer.microphone.stopDevice();this.stream.getTracks().forEach(function(e){e.stop()})}}},{key:"pause",value:function(){this.paused||(this.pauseTime=performance.now(),this.paused=!0,this.engine.pause())}},{key:"resume",value:function(){this.paused&&(this.pausedTime+=performance.now()-this.pauseTime,this.engine.resume(),this.paused=!1)}},{key:"onRecordComplete",value:function(){var e=this;if(this.player.recordedData=this.engine.recordedData,void 0!==this.player.controlBar.playToggle&&(this.player.controlBar.playToggle.removeClass("vjs-ended"),this.player.controlBar.playToggle.show()),void 0!==this.converter&&this.converter.convert(this.player.recordedData),this.player.trigger(R.default.FINISH_RECORD),!this.isDestroyed())switch(this.getRecordType()){case A.AUDIO_ONLY:this.surfer.pause(),this.surfer.setupPlaybackEvents(!0),this.player.loadingSpinner.show(),this.surfer.surfer.once(R.default.READY,function(){e._processing=!1}),this.load(this.player.recordedData);break;case A.VIDEO_ONLY:case A.AUDIO_VIDEO:case A.SCREEN_ONLY:this.player.one(R.default.PAUSE,function(){e._processing=!1,e.player.loadingSpinner.hide(),e.setDuration(e.streamDuration),e.on(e.player,R.default.TIMEUPDATE,e.playbackTimeUpdate),e.on(e.player,R.default.ENDED,e.playbackTimeUpdate),e.getRecordType()===A.AUDIO_VIDEO&&(e.mediaElement.muted=!1,e.displayVolumeControl(!0)),e.load(e.player.recordedData)}),this.player.pause();break;case A.ANIMATION:this._processing=!1,this.player.loadingSpinner.hide(),this.setDuration(this.streamDuration),this.mediaElement.style.display="none",this.player.recordCanvas.show(),this.player.pause(),this.on(this.player,R.default.PLAY,this.showAnimation),this.on(this.player,R.default.PAUSE,this.hideAnimation)}}},{key:"onCountDown",value:function(){if(!this.paused){var e=performance.now(),t=this.maxLength,i=(e-(this.startTime+this.pausedTime))/1e3;this.streamDuration=i,i>=t&&(i=t,this.stop()),this.setDuration(t),this.setCurrentTime(i,t),this.player.trigger(R.default.PROGRESS_RECORD)}}},{key:"getCurrentTime",value:function(){var e=isNaN(this.streamCurrentTime)?0:this.streamCurrentTime;return this.getRecordType()===A.AUDIO_ONLY&&(e=this.surfer.getCurrentTime()),e}},{key:"setCurrentTime",value:function(e,t){switch(e=isNaN(e)?0:e,t=isNaN(t)?0:t,this.getRecordType()){case A.AUDIO_ONLY:this.surfer.setCurrentTime(e,t);break;case A.VIDEO_ONLY:case A.AUDIO_VIDEO:case A.ANIMATION:case A.SCREEN_ONLY:this.player.controlBar.currentTimeDisplay&&this.player.controlBar.currentTimeDisplay.contentEl()&&(this.streamCurrentTime=Math.min(e,t),this.player.controlBar.currentTimeDisplay.formattedTime_=this.player.controlBar.currentTimeDisplay.contentEl().lastChild.textContent=(0,b.default)(this.streamCurrentTime,t,this.msDisplayMax))}}},{key:"getDuration",value:function(){return isNaN(this.streamDuration)?0:this.streamDuration}},{key:"setDuration",value:function(e){switch(e=isNaN(e)?0:e,this.getRecordType()){case A.AUDIO_ONLY:this.surfer.setDuration(e);break;case A.VIDEO_ONLY:case A.AUDIO_VIDEO:case A.ANIMATION:case A.SCREEN_ONLY:this.player.controlBar.durationDisplay&&this.player.controlBar.durationDisplay.contentEl()&&(this.player.controlBar.durationDisplay.formattedTime_=this.player.controlBar.durationDisplay.contentEl().lastChild.textContent=(0,b.default)(e,e,this.msDisplayMax))}}},{key:"load",value:function(e){switch(this.getRecordType()){case A.AUDIO_ONLY:this.surfer.load(e);break;case A.IMAGE_ONLY:case A.VIDEO_ONLY:case A.AUDIO_VIDEO:case A.ANIMATION:case A.SCREEN_ONLY:e instanceof Blob||e instanceof File?(this.mediaElement.srcObject=null,this.mediaElement.src=URL.createObjectURL(e)):(0,D.default)(e,this.mediaElement)}}},{key:"saveAs",value:function(e){this.engine&&void 0!==e&&this.engine.saveAs(e)}},{key:"dispose",value:function(){this.player.off(R.default.READY),this.player.off(R.default.USERINACTIVE),this.player.off(R.default.LOADEDMETADATA),this.engine&&(this.engine.dispose(),this.engine.destroy(),this.engine.off(R.default.RECORD_COMPLETE,this.engineStopCallback)),this.stop(),this.stopDevice(),this.removeRecording(),this.player.clearInterval(this.countDown),this.getRecordType()===A.AUDIO_ONLY&&this.surfer&&this.surfer.destroy(),this.resetState(),(0,d.default)((0,l.default)(t.prototype),"dispose",this).call(this)}},{key:"destroy",value:function(){this.player.dispose()}},{key:"reset",value:function(){var e=this;switch(this.engine&&(this.engine.dispose(),this.engine.off(R.default.RECORD_COMPLETE,this.engineStopCallback)),this.stop(),this.stopDevice(),this.player.clearInterval(this.countDown),this.removeRecording(),this.loadOptions(),this.resetState(),this.setDuration(this.maxLength),this.setCurrentTime(0),this.player.reset(),this.getRecordType()){case A.AUDIO_ONLY:this.surfer&&this.surfer.surfer&&this.surfer.surfer.empty();break;case A.IMAGE_ONLY:case A.ANIMATION:this.player.recordCanvas.hide(),this.player.cameraButton.hide()}void 0!==this.player.controlBar.playToggle&&this.player.controlBar.playToggle.hide(),this.player.deviceButton.show(),this.player.recordToggle.hide(),this.player.one(R.default.LOADEDMETADATA,function(){e.setDuration(e.maxLength)})}},{key:"resetState",value:function(){this._recording=!1,this._processing=!1,this._deviceActive=!1,this.devices=[]}},{key:"removeRecording",value:function(){this.mediaElement&&!0===this.mediaElement.src.startsWith("blob:")&&(URL.revokeObjectURL(this.mediaElement.src),this.mediaElement.src="")}},{key:"muteTracks",value:function(e){(this.getRecordType()===A.AUDIO_ONLY||this.getRecordType()===A.AUDIO_VIDEO)&&this.stream.getAudioTracks().length>0&&(this.stream.getAudioTracks()[0].enabled=!e),this.getRecordType()!==A.AUDIO_ONLY&&this.stream.getVideoTracks().length>0&&(this.stream.getVideoTracks()[0].enabled=!e)}},{key:"getRecordType",value:function(){return(0,A.getRecorderMode)(this.recordImage,this.recordAudio,this.recordVideo,this.recordAnimation,this.recordScreen)}},{key:"createSnapshot",value:function(){var e=this;this.captureFrame().then(function(t){e.player.recordedData=t.toDataURL("image/png"),e.mediaElement.style.display="none",e.player.recordCanvas.show(),e.stop()})}},{key:"retrySnapshot",value:function(){this._processing=!1,this.player.recordCanvas.hide(),this.player.el().firstChild.style.display="block"}},{key:"captureFrame",value:function(){var e=this,t=(0,_.detectBrowser)(),i=this.player.recordCanvas.el().firstChild;return i.width=this.player.width(),i.height=this.player.height(),new Promise(function(r,n){if("chrome"===t.browser&&t.version>=60&&("undefined"==typeof ImageCapture?"undefined":(0,o.default)(ImageCapture))===("undefined"==typeof Function?"undefined":(0,o.default)(Function)))try{var a=e.stream.getVideoTracks()[0];new ImageCapture(a).grabFrame().then(function(t){e.drawCanvas(i,t),r(i)}).catch(function(e){})}catch(e){}e.drawCanvas(i,e.mediaElement),r(i)})}},{key:"drawCanvas",value:function(e,t){e.getContext("2d").drawImage(t,0,0,e.width,e.height)}},{key:"startVideoPreview",value:function(){this.off(R.default.TIMEUPDATE),this.off(R.default.DURATIONCHANGE),this.off(R.default.LOADEDMETADATA),this.off(R.default.PLAY),this.mediaElement.muted=!0,this.displayVolumeControl(!1),this.removeRecording(),this.load(this.stream),this.mediaElement.play()}},{key:"showAnimation",value:function(){var e=this.player.animationDisplay.el().firstChild;e.width=this.player.width(),e.height=this.player.height(),this.player.recordCanvas.hide(),(0,D.default)(this.player.recordedData,e),this.player.animationDisplay.show()}},{key:"hideAnimation",value:function(){this.player.recordCanvas.show(),this.player.animationDisplay.hide()}},{key:"playbackTimeUpdate",value:function(){this.setCurrentTime(this.player.currentTime(),this.streamDuration)}},{key:"onTimeStamp",value:function(e,t){var i;switch(this.player.currentTimestamp=e,this.player.allTimestamps=t,this.getRecordType()){case A.AUDIO_ONLY:i=this.engine.engine.audioRecorder;break;case A.ANIMATION:i=this.engine.engine.gifRecorder;break;default:i=this.engine.engine.videoRecorder}var r=!1;(i&&(i=i.getInternalRecorder()),i instanceof MediaStreamRecorder==!0)&&(this.player.recordedData=i.getArrayOfBlobs(),this.engine.addFileInfo(this.player.recordedData[this.player.recordedData.length-1]),this.maxFileSize>0&&new Blob(this.player.recordedData).size>=this.maxFileSize&&(r=!0));this.player.trigger(R.default.TIMESTAMP),r&&this.stop()}},{key:"enumerateDevices",value:function(){var e=this;if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return this.player.enumerateErrorCode="enumerateDevices() not supported.",void this.player.trigger(R.default.ENUMERATE_ERROR);navigator.mediaDevices.enumerateDevices(this).then(function(t){e.devices=[],t.forEach(function(t){e.devices.push(t)}),e.player.trigger(R.default.ENUMERATE_READY)}).catch(function(t){e.player.enumerateErrorCode=t,e.player.trigger(R.default.ENUMERATE_ERROR)})}},{key:"setAudioOutput",value:function(e){var t,i=this;switch(this.getRecordType()){case A.AUDIO_ONLY:this.surfer.surfer.setSinkId(e).then(function(e){i.player.trigger(R.default.AUDIO_OUTPUT_READY)}).catch(function(e){t=e});break;default:var r=player.tech_.el_;e?void 0!==r.sinkId?r.setSinkId(e).then(function(e){i.player.trigger(R.default.AUDIO_OUTPUT_READY)}).catch(function(e){t=e}):t="Browser does not support audio output device selection.":t="Invalid deviceId: "+e}this.player.trigger(R.default.ERROR,t)}},{key:"displayVolumeControl",value:function(e){void 0!==this.player.controlBar.volumePanel&&(e=!0===e?"flex":"none",this.player.controlBar.volumePanel.el().style.display=e)}},{key:"onEnterPiP",value:function(e){this.player.trigger(R.default.ENTER_PIP,e)}},{key:"onLeavePiP",value:function(e){this.player.trigger(R.default.LEAVE_PIP)}}]),t}(I);t.Record=w,w.VERSION="3.6.0",h.default.Record=w,void 0===h.default.getPlugin("record")&&h.default.registerPlugin("record",w)},function(e,t,i){var r=i(1);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e}},function(e,t){function i(t,r){return e.exports=i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(t,r)}e.exports=i},function(e,t,i){"use strict";var r=i(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(i(2)),n=r(i(3)),a=r(i(4)),s=r(i(1)),u=r(i(7)),l=r(i(5)),d=r(i(6)).default.getComponent("Component"),c=function(e){function t(){return(0,o.default)(this,t),(0,a.default)(this,(0,s.default)(t).apply(this,arguments))}return(0,l.default)(t,e),(0,n.default)(t,[{key:"createEl",value:function(){return(0,u.default)((0,s.default)(t.prototype),"createEl",this).call(this,"div",{className:"vjs-animation-display",innerHTML:"<img />"})}}]),t}(d);d.registerComponent("AnimationDisplay",c);var h=c;t.default=h,e.exports=t.default},function(e,t,i){"use strict";var r=i(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(i(2)),n=r(i(3)),a=r(i(4)),s=r(i(1)),u=r(i(7)),l=r(i(5)),d=r(i(6)).default.getComponent("Component"),c=function(e){function t(){return(0,o.default)(this,t),(0,a.default)(this,(0,s.default)(t).apply(this,arguments))}return(0,l.default)(t,e),(0,n.default)(t,[{key:"createEl",value:function(){return(0,u.default)((0,s.default)(t.prototype),"createEl",this).call(this,"div",{className:"vjs-record-canvas",innerHTML:"<canvas></canvas>"})}}]),t}(d);d.registerComponent("RecordCanvas",c);var h=c;t.default=h,e.exports=t.default},function(e,t,i){"use strict";var r=i(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(i(2)),n=r(i(3)),a=r(i(4)),s=r(i(1)),u=r(i(7)),l=r(i(5)),d=r(i(6)),c=d.default.getComponent("Button"),h=d.default.getComponent("Component"),f=function(e){function t(){return(0,o.default)(this,t),(0,a.default)(this,(0,s.default)(t).apply(this,arguments))}return(0,l.default)(t,e),(0,n.default)(t,[{key:"handleClick",value:function(e){this.player_.record().getDevice()}},{key:"show",value:function(){this.layoutExclude&&!0===this.layoutExclude||(0,u.default)((0,s.default)(t.prototype),"show",this).call(this)}}]),t}(c);f.prototype.controlText_="Device",h.registerComponent("DeviceButton",f);var p=f;t.default=p,e.exports=t.default},function(e,t,i){"use strict";var r=i(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(i(2)),n=r(i(3)),a=r(i(4)),s=r(i(1)),u=r(i(7)),l=r(i(5)),d=r(i(6)),c=r(i(8)),h=d.default.getComponent("Button"),f=d.default.getComponent("Component"),p=function(e){function t(){return(0,o.default)(this,t),(0,a.default)(this,(0,s.default)(t).apply(this,arguments))}return(0,l.default)(t,e),(0,n.default)(t,[{key:"buildCSSClass",value:function(){return"vjs-camera-button vjs-control vjs-button vjs-icon-photo-camera"}},{key:"enable",value:function(){(0,u.default)((0,s.default)(t.prototype),"enable",this).call(this),this.on(this.player_,c.default.START_RECORD,this.onStart),this.on(this.player_,c.default.STOP_RECORD,this.onStop)}},{key:"disable",value:function(){(0,u.default)((0,s.default)(t.prototype),"disable",this).call(this),this.off(this.player_,c.default.START_RECORD,this.onStart),this.off(this.player_,c.default.STOP_RECORD,this.onStop)}},{key:"show",value:function(){this.layoutExclude&&!0===this.layoutExclude||(0,u.default)((0,s.default)(t.prototype),"show",this).call(this)}},{key:"handleClick",value:function(e){var t=this.player_.record();t.isProcessing()?(t.retrySnapshot(),this.onStop()):t.start()}},{key:"onStart",value:function(e){this.removeClass("vjs-icon-photo-camera"),this.addClass("vjs-icon-replay"),this.controlText("Retry")}},{key:"onStop",value:function(e){this.removeClass("vjs-icon-replay"),this.addClass("vjs-icon-photo-camera"),this.controlText("Image")}}]),t}(h);p.prototype.controlText_="Image",f.registerComponent("CameraButton",p);var y=p;t.default=y,e.exports=t.default},function(e,t,i){"use strict";var r=i(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(i(2)),n=r(i(3)),a=r(i(4)),s=r(i(1)),u=r(i(7)),l=r(i(5)),d=r(i(6)),c=r(i(8)),h=d.default.getComponent("Button"),f=d.default.getComponent("Component"),p=function(e){function t(){return(0,o.default)(this,t),(0,a.default)(this,(0,s.default)(t).apply(this,arguments))}return(0,l.default)(t,e),(0,n.default)(t,[{key:"buildCSSClass",value:function(){return"vjs-record-button vjs-control vjs-button vjs-icon-record-start"}},{key:"enable",value:function(){(0,u.default)((0,s.default)(t.prototype),"enable",this).call(this),this.on(this.player_,c.default.START_RECORD,this.onStart),this.on(this.player_,c.default.STOP_RECORD,this.onStop)}},{key:"disable",value:function(){(0,u.default)((0,s.default)(t.prototype),"disable",this).call(this),this.off(this.player_,c.default.START_RECORD,this.onStart),this.off(this.player_,c.default.STOP_RECORD,this.onStop)}},{key:"show",value:function(){this.layoutExclude&&!0===this.layoutExclude||(0,u.default)((0,s.default)(t.prototype),"show",this).call(this)}},{key:"handleClick",value:function(e){var t=this.player_.record();t.isRecording()?t.stop():t.start()}},{key:"onStart",value:function(e){this.removeClass("vjs-icon-record-start"),this.addClass("vjs-icon-record-stop"),this.controlText("Stop")}},{key:"onStop",value:function(e){this.removeClass("vjs-icon-record-stop"),this.addClass("vjs-icon-record-start"),this.controlText("Record")}}]),t}(h);p.prototype.controlText_="Record",f.registerComponent("RecordToggle",p);var y=p;t.default=y,e.exports=t.default},function(e,t,i){"use strict";var r=i(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(i(2)),n=r(i(3)),a=r(i(4)),s=r(i(1)),u=r(i(7)),l=r(i(5)),d=r(i(6)),c=r(i(8)),h=d.default.getComponent("Component"),f=function(e){function t(e,i){var r;return(0,o.default)(this,t),(r=(0,a.default)(this,(0,s.default)(t).call(this,e,i))).enable(),r}return(0,l.default)(t,e),(0,n.default)(t,[{key:"createEl",value:function(){var e={"data-label":this.localize("REC")};return(0,u.default)((0,s.default)(t.prototype),"createEl",this).call(this,"div",{className:"vjs-record-indicator vjs-control",dir:"ltr"},e)}},{key:"enable",value:function(){this.on(this.player_,c.default.START_RECORD,this.show),this.on(this.player_,c.default.STOP_RECORD,this.hide)}},{key:"disable",value:function(){this.off(this.player_,c.default.START_RECORD,this.show),this.off(this.player_,c.default.STOP_RECORD,this.hide)}},{key:"show",value:function(){this.layoutExclude&&!0===this.layoutExclude||(0,u.default)((0,s.default)(t.prototype),"show",this).call(this)}}]),t}(h);h.registerComponent("RecordIndicator",f);var p=f;t.default=p,e.exports=t.default},function(e,t,i){"use strict";var r=i(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(i(26)),n=r(i(28)),a=r(i(2)),s=r(i(3)),u=r(i(4)),l=r(i(1)),d=r(i(7)),c=r(i(5)),h=r(i(6)),f=r(i(8)),p=h.default.getComponent("Button"),y=h.default.getComponent("Component"),v=function(e){function t(e,i){var r;return(0,a.default)(this,t),(r=(0,u.default)(this,(0,l.default)(t).call(this,e,i))).on(r.player_,f.default.ENTER_PIP,r.onStart),r.on(r.player_,f.default.LEAVE_PIP,r.onStop),r}return(0,c.default)(t,e),(0,s.default)(t,[{key:"buildCSSClass",value:function(){return"vjs-pip-button vjs-control vjs-button vjs-icon-picture-in-picture-start"}},{key:"show",value:function(){this.layoutExclude&&!0===this.layoutExclude||(0,d.default)((0,l.default)(t.prototype),"show",this).call(this)}},{key:"handleClick",value:function(){var e=(0,n.default)(o.default.mark(function e(t){var i;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.player_.record(),this.disable(),e.prev=2,i.mediaElement===document.pictureInPictureElement){e.next=8;break}return e.next=6,i.mediaElement.requestPictureInPicture();case 6:e.next=10;break;case 8:return e.next=10,document.exitPictureInPicture();case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),this.player_.trigger(f.default.ERROR,e.t0);case 15:return e.prev=15,this.enable(),e.finish(15);case 18:case"end":return e.stop()}},e,this,[[2,12,15,18]])}));return function(t){return e.apply(this,arguments)}}()},{key:"onStart",value:function(e){this.removeClass("vjs-icon-picture-in-picture-start"),this.addClass("vjs-icon-picture-in-picture-stop")}},{key:"onStop",value:function(e){this.removeClass("vjs-icon-picture-in-picture-stop"),this.addClass("vjs-icon-picture-in-picture-start")}}]),t}(p);v.prototype.controlText_="Picture in Picture",y.registerComponent("PictureInPictureToggle",v);var g=v;t.default=g,e.exports=t.default},function(e,t,i){e.exports=i(27)},function(e,t,i){var r=function(e){"use strict";var t,i=Object.prototype,r=i.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},n=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(e,t,i,r){var o=t&&t.prototype instanceof y?t:y,n=Object.create(o.prototype),a=new A(r||[]);return n._invoke=function(e,t,i){var r=d;return function(o,n){if(r===h)throw new Error("Generator is already running");if(r===f){if("throw"===o)throw n;return k()}for(i.method=o,i.arg=n;;){var a=i.delegate;if(a){var s=D(a,i);if(s){if(s===p)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===d)throw r=f,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=h;var u=l(e,t,i);if("normal"===u.type){if(r=i.done?f:c,u.arg===p)continue;return{value:u.arg,done:i.done}}"throw"===u.type&&(r=f,i.method="throw",i.arg=u.arg)}}}(e,i,a),n}function l(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d="suspendedStart",c="suspendedYield",h="executing",f="completed",p={};function y(){}function v(){}function g(){}var m={};m[n]=function(){return this};var E=Object.getPrototypeOf,R=E&&E(E(I([])));R&&R!==i&&r.call(R,n)&&(m=R);var T=g.prototype=y.prototype=Object.create(m);function O(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function b(e){var t;this._invoke=function(i,o){function n(){return new Promise(function(t,n){!function t(i,o,n,a){var s=l(e[i],e,o);if("throw"!==s.type){var u=s.arg,d=u.value;return d&&"object"==typeof d&&r.call(d,"__await")?Promise.resolve(d.__await).then(function(e){t("next",e,n,a)},function(e){t("throw",e,n,a)}):Promise.resolve(d).then(function(e){u.value=e,n(u)},function(e){return t("throw",e,n,a)})}a(s.arg)}(i,o,t,n)})}return t=t?t.then(n,n):n()}}function D(e,i){var r=e.iterator[i.method];if(r===t){if(i.delegate=null,"throw"===i.method){if(e.iterator.return&&(i.method="return",i.arg=t,D(e,i),"throw"===i.method))return p;i.method="throw",i.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var o=l(r,e.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,p;var n=o.arg;return n?n.done?(i[e.resultName]=n.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,p):n:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,p)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function I(e){if(e){var i=e[n];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function i(){for(;++o<e.length;)if(r.call(e,o))return i.value=e[o],i.done=!1,i;return i.value=t,i.done=!0,i};return a.next=a}}return{next:k}}function k(){return{value:t,done:!0}}return v.prototype=T.constructor=g,g.constructor=v,g[s]=v.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(T),e},e.awrap=function(e){return{__await:e}},O(b.prototype),b.prototype[a]=function(){return this},e.AsyncIterator=b,e.async=function(t,i,r,o){var n=new b(u(t,i,r,o));return e.isGeneratorFunction(i)?n:n.next().then(function(e){return e.done?e.value:n.next()})},O(T),T[s]="Generator",T[n]=function(){return this},T.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var i in e)t.push(i);return t.reverse(),function i(){for(;t.length;){var r=t.pop();if(r in e)return i.value=r,i.done=!1,i}return i.done=!0,i}},e.values=I,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function o(r,o){return s.type="throw",s.arg=e,i.next=r,o&&(i.method="next",i.arg=t),!!o}for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var n=o;break}}n&&("break"===e||"continue"===e)&&n.tryLoc<=t&&t<=n.finallyLoc&&(n=null);var a=n?n.completion:{};return a.type=e,a.arg=t,n?(this.method="next",this.next=n.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),C(i),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var r=i.completion;if("throw"===r.type){var o=r.arg;C(i)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,i,r){return this.delegate={iterator:I(e),resultName:i,nextLoc:r},"next"===this.method&&(this.arg=t),p}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t){function i(e,t,i,r,o,n,a){try{var s=e[n](a),u=s.value}catch(e){return void i(e)}s.done?t(u):Promise.resolve(u).then(r,o)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise(function(o,n){var a=e.apply(t,r);function s(e){i(a,o,n,s,u,"next",e)}function u(e){i(a,o,n,s,u,"throw",e)}s(void 0)})}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(9),o=function(e){switch(e.which){case 88:switch(this.player_.record().getRecordType()){case r.IMAGE_ONLY:this.player_.cameraButton.trigger("click");break;default:this.player_.recordToggle.trigger("click")}break;case 80:!0===this.player_.record().pictureInPicture&&this.player_.pipToggle.trigger("click");break;case 67:this.player_.controlBar.playToggle&&this.player_.controlBar.playToggle.contentEl()&&player.controlBar.playToggle.trigger("click")}};t.default=o,e.exports=t.default},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={image:!1,audio:!1,video:!1,animation:!1,screen:!1,maxLength:10,maxFileSize:0,msDisplayMax:3,frameWidth:320,frameHeight:240,debug:!1,pip:!1,autoMuteDevice:!1,videoEngine:"recordrtc",videoMimeType:"video/webm",videoRecorderType:"auto",videoWorkerURL:"",videoWebAssemblyURL:"",audioEngine:"recordrtc",audioRecorderType:"auto",audioMimeType:"auto",audioBufferSize:4096,audioSampleRate:44100,audioBitRate:128,audioChannels:2,audioWorkerURL:"",audioWebAssemblyURL:"",audioBufferUpdate:!1,animationFrameRate:200,animationQuality:10,timeSlice:0,convertEngine:"",hotKeys:!1};t.default=r,e.exports=t.default},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e,t,i){e=e<0?0:e,t=t||e;var r=Math.floor(e%60),o=Math.floor(e/60%60),n=Math.floor(e/3600),a=Math.floor(t/60%60),s=Math.floor(t/3600),u=Math.floor(1e3*(e-r));return(isNaN(e)||e===1/0)&&(n=o=r=u="-"),t>0&&t<i?(u<100&&(u=u<10?"00"+u:"0"+u),u=":"+u):u="",(n=n>0||s>0?n+":":"")+(o=((n||a>=10)&&o<10?"0"+o:o)+":")+(r=r<10?"0"+r:r)+u};t.default=r,e.exports=t.default},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e,t){"srcObject"in t?t.srcObject=e:"mozSrcObject"in t?t.mozSrcObject=e:t.srcObject=e};t.default=r,e.exports=t.default},function(e,t,i){(function(t){var i;i="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},e.exports=i}).call(this,i(34))},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t,i){"use strict";var r=i(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getConvertEngine=t.getVideoEngine=t.isAudioPluginActive=t.getAudioEngine=void 0;var o=r(i(36)),n=i(38),a=i(13);t.getAudioEngine=function(e){var t;switch(e){case a.RECORDRTC:t=o.default;break;case a.LIBVORBISJS:t=videojs.LibVorbisEngine;break;case a.RECORDERJS:t=videojs.RecorderjsEngine;break;case a.LAMEJS:t=videojs.LamejsEngine;break;case a.OPUSRECORDER:t=videojs.OpusRecorderEngine;break;case a.VMSG:t=videojs.VmsgEngine;break;default:throw new Error("Unknown audioEngine: "+e)}return t};t.getVideoEngine=function(e){var t;switch(e){case a.RECORDRTC:t=o.default;break;case a.WEBMWASM:t=videojs.WebmWasmEngine;break;default:throw new Error("Unknown videoEngine: "+e)}return t};t.isAudioPluginActive=function(e){return a.AUDIO_PLUGINS.indexOf(e)>-1};t.getConvertEngine=function(e){var t;switch(e){case"":break;case n.TSEBML:t=videojs.TsEBMLEngine;break;default:throw new Error("Unknown convertEngine: "+e)}return t}},function(e,t,i){"use strict";var r=i(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(i(2)),n=r(i(3)),a=r(i(4)),s=r(i(1)),u=r(i(7)),l=r(i(5)),d=r(i(6)),c=r(i(37)),h=r(i(8)),f=i(13),p=(i(12),i(9)),y=d.default.getComponent("Component"),v=function(e){function t(){return(0,o.default)(this,t),(0,a.default)(this,(0,s.default)(t).apply(this,arguments))}return(0,l.default)(t,e),(0,n.default)(t,[{key:"setup",value:function(e,t,i){this.inputStream=e,this.mediaType=t,this.debug=i,"screen"in this.mediaType&&(this.mediaType.video=!0),void 0!==this.recorderType&&(this.mediaType.video=this.recorderType),this.engine=new c.default.MRecordRTC,this.engine.mediaType=this.mediaType,this.engine.disableLogs=!this.debug,this.engine.mimeType=this.mimeType,this.engine.bufferSize=this.bufferSize,this.engine.sampleRate=this.sampleRate,this.engine.numberOfAudioChannels=this.audioChannels,this.engine.video=this.video,this.engine.canvas=this.canvas,this.engine.quality=this.quality,this.engine.frameRate=this.frameRate,void 0!==this.onTimeStamp&&(this.engine.timeSlice=this.timeSlice,this.engine.onTimeStamp=this.onTimeStamp),this.engine.workerPath=this.workerPath,this.engine.webAssemblyPath=this.videoWebAssemblyURL,this.engine.addStream(this.inputStream)}},{key:"dispose",value:function(){(0,u.default)((0,s.default)(t.prototype),"dispose",this).call(this),this.destroy()}},{key:"destroy",value:function(){this.engine&&"function"==typeof this.engine.destroy&&this.engine.destroy()}},{key:"start",value:function(){this.engine.startRecording()}},{key:"stop",value:function(){this.engine.stopRecording(this.onStopRecording.bind(this))}},{key:"pause",value:function(){this.engine.pauseRecording()}},{key:"resume",value:function(){this.engine.resumeRecording()}},{key:"saveAs",value:function(e){this.engine&&void 0!==e&&this.engine.save(e)}},{key:"onStopRecording",value:function(e,t){var i=this;URL.revokeObjectURL(e);var r=this.player().record().getRecordType();this.engine.getBlob(function(e){switch(r){case p.AUDIO_ONLY:void 0!==e.audio&&(i.recordedData=e.audio);break;case p.VIDEO_ONLY:case p.AUDIO_VIDEO:case p.SCREEN_ONLY:void 0!==e.video&&(i.recordedData=e.video);break;case p.ANIMATION:void 0!==e.gif&&(i.recordedData=e.gif)}i.addFileInfo(i.recordedData),i.trigger(h.default.RECORD_COMPLETE)})}}]),t}(f.RecordEngine);d.default.RecordRTCEngine=v,y.registerComponent("RecordRTCEngine",v);var g=v;t.default=g,e.exports=t.default},function(e,i){e.exports=t},function(e,t,i){"use strict";var r=i(0);Object.defineProperty(t,"__esModule",{value:!0}),t.TSEBML=t.CONVERT_PLUGINS=t.ConvertEngine=void 0;var o=r(i(2)),n=r(i(3)),a=r(i(4)),s=r(i(1)),u=r(i(5)),l=r(i(6)),d=i(14),c=l.default.getComponent("Component");t.TSEBML="ts-ebml";var h=["ts-ebml"];t.CONVERT_PLUGINS=h;var f=function(e){function t(e,i){return(0,o.default)(this,t),i.evented=!0,(0,a.default)(this,(0,s.default)(t).call(this,e,i))}return(0,u.default)(t,e),(0,n.default)(t,[{key:"setup",value:function(e,t){this.mediaType=e,this.debug=t}},{key:"loadBlob",value:function(e){return(0,d.blobToArrayBuffer)(e)}},{key:"addFileInfo",value:function(e,t){(0,d.addFileInfo)(e,t)}}]),t}(c);t.ConvertEngine=f,l.default.ConvertEngine=f,c.registerComponent("ConvertEngine",f)},function(e,t,i){}])});